import{q as F,r as k,j as e,y as S,f as H,g as z,h as V,i as J,t as I,k as K,m as E,n as Q,o as Z,W as ee,p as te,b as re}from"./app-94ff2bf7.js";import{T as ae,a as oe,b as se,C as ne,d as le,D as ie,S as de}from"./Search-709e47eb.js";import{d as L,D as O,a as A,b as ce}from"./ModeEditOutline-dc9b42b0.js";import{D as q,d as Y}from"./dayjs.min-ae88995b.js";import{B as f}from"./Box-bfd92c26.js";import{B as b}from"./Button-74c67291.js";import{T as G,F as fe,S as ue}from"./TextField-20cf0c6b.js";import{I as me}from"./InputAdornment-a01497de.js";import{I as _}from"./IconButton-8b786467.js";import{h as he}from"./moment-fbc5633a.js";import{N as xe}from"./NotFoundData-f621d7d0.js";import{P as pe}from"./Menu-e18445c6.js";import{D as B,a as W,b as P}from"./DialogContent-a72381c5.js";import{T as j}from"./Typography-f969e485.js";import{M as ge,A as ve}from"./AuthenticatedLayout-4304848d.js";import{G as R}from"./Grid-f2c64255.js";import"./Close-f1c77360.js";import"./createSvgIcon-4d4aaaec.js";function je({resource:o,clickOpenNewEvent:d}){var i;const{events:l,auth:c}=F().props,[u,M]=k.useState(""),[r,m]=k.useState(),a=(s,D)=>{M(D),o&&S.get(o,{search:r,status:D},{preserveState:!0})},h=s=>{m(s.target.value),o&&S.get(o,{search:s.target.value,status:u},{preserveState:!0})};return e.jsxs(f,{display:"flex",alignItems:"center",children:[e.jsx(ae,{value:u,children:e.jsx(f,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsx(oe,{onChange:a,"aria-label":"lab API tabs example",children:e.jsx(se,{label:e.jsxs("div",{children:["Todos",e.jsx(ne,{sx:{background:"white",color:"black",ml:1,borderRadius:"5px"},size:"small",label:2})]}),value:""})})})}),e.jsxs(f,{ml:2,flex:1,display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:2,children:[d&&e.jsx(b,{variant:"contained",color:"primary",onClick:d,disabled:!((i=c==null?void 0:c.roles)!=null&&i.some(s=>s==="create events")),children:"Criar Evento"}),e.jsx(G,{InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(le,{sx:{color:"#fff"}})})},InputLabelProps:{shrink:!1},color:"secondary",required:!0,id:"search",placeholder:"Buscar",name:"search",value:r,onChange:h}),e.jsx(q,{sx:{width:"207px",backgroundColor:"#2E2E2E",color:"#fff",borderRadius:"10px !important","& .MuiIconButton-root":{color:"primary.main"}}}),e.jsx(b,{variant:"outlined",color:"primary",children:"Encerrar eventos"}),e.jsx(_,{"aria-label":"delete",sx:{mr:2},children:e.jsx(L,{sx:{color:"#ffffff"}})})]})]})}function be(o){return H({},o)}var X=1440,De=2520,y=43200,Ce=86400;function Se(o,d,l){var c,u;z(2,arguments);var M=Z(),r=(c=(u=l==null?void 0:l.locale)!==null&&u!==void 0?u:M.locale)!==null&&c!==void 0?c:V;if(!r.formatDistance)throw new RangeError("locale must contain formatDistance property");var m=J(o,d);if(isNaN(m))throw new RangeError("Invalid time value");var a=H(be(l),{addSuffix:!!(l!=null&&l.addSuffix),comparison:m}),h,i;m>0?(h=I(d),i=I(o)):(h=I(o),i=I(d));var s=K(i,h),D=(E(i)-E(h))/1e3,n=Math.round((s-D)/60),p;if(n<2)return l!=null&&l.includeSeconds?s<5?r.formatDistance("lessThanXSeconds",5,a):s<10?r.formatDistance("lessThanXSeconds",10,a):s<20?r.formatDistance("lessThanXSeconds",20,a):s<40?r.formatDistance("halfAMinute",0,a):s<60?r.formatDistance("lessThanXMinutes",1,a):r.formatDistance("xMinutes",1,a):n===0?r.formatDistance("lessThanXMinutes",1,a):r.formatDistance("xMinutes",n,a);if(n<45)return r.formatDistance("xMinutes",n,a);if(n<90)return r.formatDistance("aboutXHours",1,a);if(n<X){var N=Math.round(n/60);return r.formatDistance("aboutXHours",N,a)}else{if(n<De)return r.formatDistance("xDays",1,a);if(n<y){var C=Math.round(n/X);return r.formatDistance("xDays",C,a)}else if(n<Ce)return p=Math.round(n/y),r.formatDistance("aboutXMonths",p,a)}if(p=Q(i,h),p<12){var v=Math.round(n/y);return r.formatDistance("xMonths",v,a)}else{var g=p%12,w=Math.floor(p/12);return g<3?r.formatDistance("aboutXYears",w,a):g<9?r.formatDistance("overXYears",w,a):r.formatDistance("almostXYears",w+1,a)}}function Me(o,d){return z(1,arguments),Se(o,Date.now(),d)}function we({events:o,resource:d}){const{errors:l,sports:c,auth:u}=F().props,M=[{field:"title",headerName:"Nome",sortable:!1,filterable:!1,flex:1},{field:"sport",headerName:"Esporte",headerAlign:"left",align:"left",sortable:!1,filterable:!1,flex:1},{field:"games.count",headerName:"Jogos",width:120,sortable:!1,filterable:!1,valueGetter:t=>t.row.games.length},{field:"created_at",headerName:"Criado em",headerAlign:"right",align:"left",sortable:!1,filterable:!1,flex:1,renderCell:t=>(console.log(t.row.end_game),e.jsxs(f,{display:"flex",flex:1,justifyContent:"space-between",children:[e.jsxs(j,{variant:"body1",color:"error",flex:1,fontWeight:400,children:["Encerra em"," ",Me(new Date(Y(t.row.end_date).format("YYYY-MM-DDTHH:mm:ss")),{locale:te})]}),e.jsx(j,{variant:"body1",children:Y(t.row.created_at).format("DD/MM/YYYY HH:mm")}),e.jsx("br",{})]}))},{field:"",headerName:"Ações",headerAlign:"center",align:"center",sortable:!1,filterable:!1,renderCell:t=>{var x;return e.jsxs(de,{direction:"row",children:[e.jsx(_,{"aria-label":"edit",sx:{mr:1},onClick:T=>{T.preventDefault(),s(!0),g(t.row),D()},children:e.jsx(ce,{sx:{color:"#ffffff"}})}),((x=u==null?void 0:u.roles)==null?void 0:x.includes("create events"))&&e.jsx(_,{"aria-label":"delete",sx:{mr:1},onClick:()=>{g(t.row),N()},children:e.jsx(L,{sx:{color:"#ffffff"}})})]})},width:200}],[r,m]=k.useState(!1),[a,h]=k.useState(!1),[i,s]=k.useState(!1),D=()=>{m(!0),s(!1)},n=()=>{w(),m(!0),s(!0)},p=()=>{s(!1),m(!1)},N=()=>{h(!0)},C=()=>{h(!1)},{data:v,setData:g,reset:w,post:Te,processing:_e}=ee({id:0,title:"",sport:"",sport_id:0,end_date:""}),U=t=>{t.preventDefault();const x=c.find(T=>T.id===v.sport_id).name;g("sport",x),setTimeout(()=>{S.post(route("events.storeFromModal"),{...v,sport:x},{preserveState:!0,onSuccess:T=>{m(!1)},onError:T=>{}})},500)};function $(){S.delete(route("events.destroy",{id:v.id}),{onSuccess:t=>{C()}})}return e.jsxs(e.Fragment,{children:[e.jsxs(pe,{elevation:5,variant:"indicator",children:[e.jsx(je,{resource:d,clickOpenNewEvent:n}),o.data.length===0?e.jsx(xe,{}):e.jsx(ie,{disableRowSelectionOnClick:!0,disableColumnMenu:!0,onRowSelectionModelChange:t=>{},onRowClick:(t,x)=>{x.target.nodeName==="DIV"&&S.get("/eventos/"+t.row.id)},disableColumnSelector:!0,rows:o.data,rowCount:o.total,paginationMode:"server",columns:M,density:"comfortable",initialState:{pagination:{paginationModel:{page:o.current_page-1,pageSize:o.per_page}}},onPaginationModelChange:(t,x)=>{S.get("/eventos",{page:t.page+1,per_page:t.pageSize},{preserveState:!0})},pageSizeOptions:[5,10],checkboxSelection:!0})]}),e.jsxs(B,{open:r,onClose:p,PaperProps:{sx:{backgroundColor:"#2e2e2e"}},maxWidth:"md",fullWidth:!0,children:[e.jsx(O,{children:"Criar Evento"}),e.jsx(_,{"aria-label":"close",onClick:p,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.primary.main},children:e.jsx(A,{})}),e.jsx(W,{children:e.jsxs(f,{component:"form",id:"form_edit",onSubmit:U,noValidate:!0,sx:{mt:1,display:"flex",flexDirection:"row"},gap:2,children:[e.jsxs(f,{display:"flex",flexDirection:"column",gap:2,width:"100%",children:[e.jsxs(f,{width:"100%",children:[e.jsx(j,{variant:"subtitle2",color:"white",fontWeight:600,children:"Nome do evento"}),e.jsx(G,{fullWidth:!0,required:!0,disabled:!i,id:"title",name:"title",placeholder:"Campeonato Brasileiro",value:v.title,error:!!l.title,helperText:l.title,onChange:t=>g("title",t.target.value),InputLabelProps:{shrink:!1}})]}),e.jsxs(f,{width:"100%",children:[e.jsx(j,{variant:"caption",color:"white",fontWeight:600,children:"Data final do evento ( o evento se encerrara automaticamente)"}),e.jsx(q,{value:new Date(v.end_date),disabled:!i,onChange:t=>g("end_date",he(t).format("YYYY-MM-DD H:mm:ss")),sx:{width:"100%",backgroundColor:"#1B1C1B",color:"#fff",borderRadius:"10px !important","& .MuiIconButton-root":{color:"primary.main"}}})]})]}),e.jsx(f,{display:"flex",flexDirection:"column",gap:2,width:"100%",children:e.jsxs(f,{width:"100%",children:[e.jsx(j,{variant:"caption",color:"white",fontWeight:600,children:"Esporte"}),e.jsx(fe,{fullWidth:!0,children:e.jsx(ue,{disabled:!i,sx:{backgroundColor:"#1B1C1B",color:"#fff"},value:v.sport_id,placeholder:"Selecione um esporte",onChange:t=>{g("sport_id",+t.target.value)},children:c&&c.map((t,x)=>e.jsx(ge,{value:t.id,children:t.name},x))})})]})})]})}),e.jsxs(P,{sx:{display:"flex",p:3},children:[!i&&e.jsx(e.Fragment,{children:e.jsx(b,{variant:"outlined",onClick:()=>{s(!0)},children:"Mudar informações"})}),i&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"contained",type:"submit",form:"form_edit",children:"Salvar"}),e.jsx(b,{variant:"outlined",onClick:()=>{s(!1)},children:"Cancelar"})]})]})]}),e.jsxs(B,{open:a,onClose:C,PaperProps:{sx:{backgroundColor:"#2e2e2e"}},maxWidth:"sm",fullWidth:!0,children:[e.jsx(O,{children:"Deletar contas"}),e.jsx(_,{"aria-label":"close",onClick:C,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.primary.main},children:e.jsx(A,{})}),e.jsx(W,{children:e.jsx(j,{variant:"body1",fontWeight:400,children:"Tem certeza que desenha deletar esse evento?"})}),e.jsx(P,{sx:{display:"flex",p:3},children:e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"contained",color:"error",onClick:$,children:"Deletar"}),e.jsx(b,{variant:"outlined",onClick:C,children:"Cancelar"})]})})]})]})}function Ge({auth:o,events:d}){return e.jsxs(ve,{user:o.user,children:[e.jsx(re,{title:"EVENTOS"}),e.jsxs(f,{children:[e.jsx(j,{variant:"h5",mb:2,children:"EVENTOS"}),e.jsx(R,{container:!0,spacing:2,children:e.jsx(R,{item:!0,xs:12,children:e.jsx(we,{events:d})})})]})]})}export{Ge as default};
