import{q as X,r as k,j as e,y as S,f as F,g as z,h as $,i as V,t as I,k as J,m as E,n as K,o as Q,W as Z,p as ee,b as te}from"./app-c45835ec.js";import{T as re,a as ae,b as se,C as oe,d as ne,D as le,S as ie}from"./Search-64415634.js";import{d as H,D as O,a as A,b as de}from"./ModeEditOutline-d7f536c0.js";import{D as L}from"./DatePicker-0467f5fd.js";import{B as f}from"./Box-3d9fba78.js";import{B as b}from"./Button-b0daae8d.js";import{T as q,F as ce,S as fe}from"./TextField-ddc657f8.js";import{I as ue}from"./InputAdornment-64666362.js";import{I as _}from"./IconButton-571f0f9a.js";import{h as me}from"./moment-fbc5633a.js";import{N as he}from"./NotFoundData-3ecf14bc.js";import{d as xe}from"./dayjs.min-7bb3f2a4.js";import{P as pe}from"./Menu-5d25c29a.js";import{D as B,a as W,b as P}from"./DialogContent-9f0a70a1.js";import{T as j}from"./Typography-0a0609e8.js";import{M as ge,A as ve}from"./AuthenticatedLayout-54c96231.js";import{G as Y}from"./Grid-ef8eac94.js";import"./Close-5b5df976.js";import"./createSvgIcon-568a0746.js";function je({resource:s,clickOpenNewEvent:d}){var i;const{events:l,auth:c}=X().props,[u,M]=k.useState(""),[r,m]=k.useState(),a=(o,D)=>{M(D),s&&S.get(s,{search:r,status:D},{preserveState:!0})},h=o=>{m(o.target.value),s&&S.get(s,{search:o.target.value,status:u},{preserveState:!0})};return e.jsxs(f,{display:"flex",alignItems:"center",children:[e.jsx(re,{value:u,children:e.jsx(f,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsx(ae,{onChange:a,"aria-label":"lab API tabs example",children:e.jsx(se,{label:e.jsxs("div",{children:["Todos",e.jsx(oe,{sx:{background:"white",color:"black",ml:1,borderRadius:"5px"},size:"small",label:2})]}),value:""})})})}),e.jsxs(f,{ml:2,flex:1,display:"flex",flexDirection:"row",justifyContent:"end",alignItems:"center",gap:2,children:[d&&e.jsx(b,{variant:"contained",color:"primary",onClick:d,disabled:!((i=c==null?void 0:c.roles)!=null&&i.some(o=>o==="create events")),children:"Criar Evento"}),e.jsx(q,{InputProps:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(ne,{sx:{color:"#fff"}})})},InputLabelProps:{shrink:!1},color:"secondary",required:!0,id:"search",placeholder:"Buscar",name:"search",value:r,onChange:h}),e.jsx(L,{sx:{width:"207px",backgroundColor:"#2E2E2E",color:"#fff",borderRadius:"10px !important","& .MuiIconButton-root":{color:"primary.main"}}}),e.jsx(b,{variant:"outlined",color:"primary",children:"Encerrar eventos"}),e.jsx(_,{"aria-label":"delete",sx:{mr:2},children:e.jsx(H,{sx:{color:"#ffffff"}})})]})]})}function be(s){return F({},s)}var R=1440,De=2520,y=43200,Ce=86400;function Se(s,d,l){var c,u;z(2,arguments);var M=Q(),r=(c=(u=l==null?void 0:l.locale)!==null&&u!==void 0?u:M.locale)!==null&&c!==void 0?c:$;if(!r.formatDistance)throw new RangeError("locale must contain formatDistance property");var m=V(s,d);if(isNaN(m))throw new RangeError("Invalid time value");var a=F(be(l),{addSuffix:!!(l!=null&&l.addSuffix),comparison:m}),h,i;m>0?(h=I(d),i=I(s)):(h=I(s),i=I(d));var o=J(i,h),D=(E(i)-E(h))/1e3,n=Math.round((o-D)/60),p;if(n<2)return l!=null&&l.includeSeconds?o<5?r.formatDistance("lessThanXSeconds",5,a):o<10?r.formatDistance("lessThanXSeconds",10,a):o<20?r.formatDistance("lessThanXSeconds",20,a):o<40?r.formatDistance("halfAMinute",0,a):o<60?r.formatDistance("lessThanXMinutes",1,a):r.formatDistance("xMinutes",1,a):n===0?r.formatDistance("lessThanXMinutes",1,a):r.formatDistance("xMinutes",n,a);if(n<45)return r.formatDistance("xMinutes",n,a);if(n<90)return r.formatDistance("aboutXHours",1,a);if(n<R){var N=Math.round(n/60);return r.formatDistance("aboutXHours",N,a)}else{if(n<De)return r.formatDistance("xDays",1,a);if(n<y){var C=Math.round(n/R);return r.formatDistance("xDays",C,a)}else if(n<Ce)return p=Math.round(n/y),r.formatDistance("aboutXMonths",p,a)}if(p=K(i,h),p<12){var v=Math.round(n/y);return r.formatDistance("xMonths",v,a)}else{var g=p%12,T=Math.floor(p/12);return g<3?r.formatDistance("aboutXYears",T,a):g<9?r.formatDistance("overXYears",T,a):r.formatDistance("almostXYears",T+1,a)}}function Me(s,d){return z(1,arguments),Se(s,Date.now(),d)}function Te({events:s,resource:d}){const{errors:l,sports:c,auth:u}=X().props,M=[{field:"title",headerName:"Nome",sortable:!1,filterable:!1,flex:1},{field:"sport",headerName:"Esporte",headerAlign:"left",align:"left",sortable:!1,filterable:!1,flex:1},{field:"games.count",headerName:"Jogos",width:120,sortable:!1,filterable:!1,valueGetter:t=>t.row.games.length},{field:"created_at",headerName:"Criado em",headerAlign:"right",align:"left",sortable:!1,filterable:!1,flex:1,renderCell:t=>(console.log(t.row.end_game),e.jsxs(f,{display:"flex",flex:1,justifyContent:"space-between",children:[e.jsxs(j,{variant:"body1",color:"error",flex:1,children:["Encerra em"," ",Me(new Date(xe(t.row.end_date).format("YYYY-MM-DDTHH:mm:ss")),{locale:ee})]}),e.jsx(j,{variant:"body1",children:"asdasda"}),e.jsx("br",{})]}))},{field:"",headerName:"Ações",sortable:!1,filterable:!1,renderCell:t=>{var x;return e.jsxs(ie,{direction:"row",children:[e.jsx(_,{"aria-label":"edit",sx:{mr:1},onClick:w=>{w.preventDefault(),o(!0),g(t.row),D()},children:e.jsx(de,{sx:{color:"#ffffff"}})}),((x=u==null?void 0:u.roles)==null?void 0:x.includes("create events"))&&e.jsx(_,{"aria-label":"delete",sx:{mr:1},onClick:()=>{g(t.row),N()},children:e.jsx(H,{sx:{color:"#ffffff"}})})]})},width:200}],[r,m]=k.useState(!1),[a,h]=k.useState(!1),[i,o]=k.useState(!1),D=()=>{m(!0),o(!1)},n=()=>{T(),m(!0),o(!0)},p=()=>{o(!1),m(!1)},N=()=>{h(!0)},C=()=>{h(!1)},{data:v,setData:g,reset:T,post:we,processing:_e}=Z({id:0,title:"",sport:"",sport_id:0,end_date:""}),G=t=>{t.preventDefault();const x=c.find(w=>w.id===v.sport_id).name;g("sport",x),setTimeout(()=>{S.post(route("events.storeFromModal"),{...v,sport:x},{preserveState:!0,onSuccess:w=>{m(!1)},onError:w=>{}})},500)};function U(){S.delete(route("events.destroy",{id:v.id}),{onSuccess:t=>{C()}})}return e.jsxs(e.Fragment,{children:[e.jsxs(pe,{elevation:5,variant:"indicator",children:[e.jsx(je,{resource:d,clickOpenNewEvent:n}),s.data.length===0?e.jsx(he,{}):e.jsx(le,{disableRowSelectionOnClick:!0,disableColumnMenu:!0,onRowSelectionModelChange:t=>{},onRowClick:(t,x)=>{x.target.nodeName==="DIV"&&S.get("/eventos/"+t.row.id)},disableColumnSelector:!0,rows:s.data,rowCount:s.total,paginationMode:"server",columns:M,density:"comfortable",initialState:{pagination:{paginationModel:{page:s.current_page-1,pageSize:s.per_page}}},onPaginationModelChange:(t,x)=>{S.get("/eventos",{page:t.page+1,per_page:t.pageSize},{preserveState:!0})},pageSizeOptions:[5,10],checkboxSelection:!0})]}),e.jsxs(B,{open:r,onClose:p,PaperProps:{sx:{backgroundColor:"#2e2e2e"}},maxWidth:"md",fullWidth:!0,children:[e.jsx(O,{children:"Criar Evento"}),e.jsx(_,{"aria-label":"close",onClick:p,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.primary.main},children:e.jsx(A,{})}),e.jsx(W,{children:e.jsxs(f,{component:"form",id:"form_edit",onSubmit:G,noValidate:!0,sx:{mt:1,display:"flex",flexDirection:"row"},gap:2,children:[e.jsxs(f,{display:"flex",flexDirection:"column",gap:2,width:"100%",children:[e.jsxs(f,{width:"100%",children:[e.jsx(j,{variant:"subtitle2",color:"white",fontWeight:600,children:"Nome do evento"}),e.jsx(q,{fullWidth:!0,required:!0,disabled:!i,id:"title",name:"title",placeholder:"Campeonato Brasileiro",value:v.title,error:!!l.title,helperText:l.title,onChange:t=>g("title",t.target.value),InputLabelProps:{shrink:!1}})]}),e.jsxs(f,{width:"100%",children:[e.jsx(j,{variant:"caption",color:"white",fontWeight:600,children:"Data final do evento ( o evento se encerrara automaticamente)"}),e.jsx(L,{value:new Date(v.end_date),disabled:!i,onChange:t=>g("end_date",me(t).format("YYYY-MM-DD H:mm:ss")),sx:{width:"100%",backgroundColor:"#1B1C1B",color:"#fff",borderRadius:"10px !important","& .MuiIconButton-root":{color:"primary.main"}}})]})]}),e.jsx(f,{display:"flex",flexDirection:"column",gap:2,width:"100%",children:e.jsxs(f,{width:"100%",children:[e.jsx(j,{variant:"caption",color:"white",fontWeight:600,children:"Esporte"}),e.jsx(ce,{fullWidth:!0,children:e.jsx(fe,{disabled:!i,sx:{backgroundColor:"#1B1C1B",color:"#fff"},value:v.sport_id,placeholder:"Selecione um esporte",onChange:t=>{g("sport_id",+t.target.value)},children:c&&c.map((t,x)=>e.jsx(ge,{value:t.id,children:t.name},x))})})]})})]})}),e.jsxs(P,{sx:{display:"flex",p:3},children:[!i&&e.jsx(e.Fragment,{children:e.jsx(b,{variant:"outlined",onClick:()=>{o(!0)},children:"Mudar informações"})}),i&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"contained",type:"submit",form:"form_edit",children:"Salvar"}),e.jsx(b,{variant:"outlined",onClick:()=>{o(!1)},children:"Cancelar"})]})]})]}),e.jsxs(B,{open:a,onClose:C,PaperProps:{sx:{backgroundColor:"#2e2e2e"}},maxWidth:"sm",fullWidth:!0,children:[e.jsx(O,{children:"Deletar contas"}),e.jsx(_,{"aria-label":"close",onClick:C,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.primary.main},children:e.jsx(A,{})}),e.jsx(W,{children:e.jsx(j,{variant:"body1",fontWeight:400,children:"Tem certeza que desenha deletar esse evento?"})}),e.jsx(P,{sx:{display:"flex",p:3},children:e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"contained",color:"error",onClick:U,children:"Deletar"}),e.jsx(b,{variant:"outlined",onClick:C,children:"Cancelar"})]})})]})]})}function Ue({auth:s,events:d}){return e.jsxs(ve,{user:s.user,children:[e.jsx(te,{title:"EVENTOS"}),e.jsxs(f,{children:[e.jsx(j,{variant:"h5",mb:2,children:"EVENTOS"}),e.jsx(Y,{container:!0,spacing:2,children:e.jsx(Y,{item:!0,xs:12,children:e.jsx(Te,{events:d})})})]})]})}export{Ue as default};
